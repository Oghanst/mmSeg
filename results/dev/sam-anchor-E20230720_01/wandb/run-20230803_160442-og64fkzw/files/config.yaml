wandb_version: 1

_wandb:
  desc: null
  value:
    python_version: 3.10.12
    cli_version: 0.15.8
    framework: huggingface
    huggingface_version: 4.31.0
    is_jupyter_run: false
    is_kaggle_kernel: false
    start_time: 1691049882.107724
    t:
      1:
      - 1
      - 5
      - 11
      - 37
      - 38
      - 41
      - 49
      - 53
      - 55
      - 60
      - 80
      - 82
      2:
      - 1
      - 5
      - 11
      - 37
      - 38
      - 41
      - 49
      - 53
      - 55
      - 60
      - 80
      - 82
      3:
      - 7
      - 13
      - 23
      4: 3.10.12
      5: 0.15.8
      6: 4.31.0
      8:
      - 5
    m:
    - 1: trainer/global_step
      6:
      - 3
    - 1: lr-AdamW
      5: 1
      6:
      - 1
    - 1: lr-AdamW-1
      5: 1
      6:
      - 1
    - 1: train_loss
      5: 1
      6:
      - 1
    - 1: train_loss_rpn_cls
      5: 1
      6:
      - 1
    - 1: train_loss_rpn_bbox
      5: 1
      6:
      - 1
    - 1: train_loss_cls
      5: 1
      6:
      - 1
    - 1: train_acc
      5: 1
      6:
      - 1
    - 1: train_loss_bbox
      5: 1
      6:
      - 1
    - 1: train_loss_mask
      5: 1
      6:
      - 1
    - 1: loss
      5: 1
      6:
      - 1
    - 1: max_grad
      5: 1
      6:
      - 1
    - 1: min_grad
      5: 1
      6:
      - 1
    - 1: epoch
      5: 1
      6:
      - 1
backbone/type:
  desc: null
  value: vit_h
backbone/checkpoint:
  desc: null
  value: pretrain/sam/sam_vit_h_4b8939.pth
neck:
  desc: null
  value: null
panoptic_head/type:
  desc: null
  value: SAMAnchorInstanceHead
panoptic_head/neck/type:
  desc: null
  value: SAMAggregatorNeck
panoptic_head/neck/in_channels:
  desc: null
  value:
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
panoptic_head/neck/inner_channels:
  desc: null
  value: 32
panoptic_head/neck/selected_channels:
  desc: null
  value:
  - 4
  - 6
  - 8
  - 10
  - 12
  - 14
  - 16
  - 18
  - 20
  - 22
  - 24
  - 26
  - 28
  - 30
panoptic_head/neck/out_channels:
  desc: null
  value: 256
panoptic_head/neck/up_sample_scale:
  desc: null
  value: 4
panoptic_head/rpn_head/type:
  desc: null
  value: mmdet.RPNHead
panoptic_head/rpn_head/in_channels:
  desc: null
  value: 256
panoptic_head/rpn_head/feat_channels:
  desc: null
  value: 256
panoptic_head/rpn_head/anchor_generator/type:
  desc: null
  value: mmdet.AnchorGenerator
panoptic_head/rpn_head/anchor_generator/scales:
  desc: null
  value:
  - 2
  - 4
  - 8
  - 16
  - 32
  - 64
panoptic_head/rpn_head/anchor_generator/ratios:
  desc: null
  value:
  - 0.5
  - 1.0
  - 2.0
panoptic_head/rpn_head/anchor_generator/strides:
  desc: null
  value:
  - 8
  - 16
  - 32
panoptic_head/rpn_head/bbox_coder/type:
  desc: null
  value: mmdet.DeltaXYWHBBoxCoder
panoptic_head/rpn_head/bbox_coder/target_means:
  desc: null
  value:
  - 0.0
  - 0.0
  - 0.0
  - 0.0
panoptic_head/rpn_head/bbox_coder/target_stds:
  desc: null
  value:
  - 1.0
  - 1.0
  - 1.0
  - 1.0
panoptic_head/rpn_head/loss_cls/type:
  desc: null
  value: mmdet.CrossEntropyLoss
panoptic_head/rpn_head/loss_cls/use_sigmoid:
  desc: null
  value: true
panoptic_head/rpn_head/loss_cls/loss_weight:
  desc: null
  value: 1.0
panoptic_head/rpn_head/loss_bbox/type:
  desc: null
  value: mmdet.SmoothL1Loss
panoptic_head/rpn_head/loss_bbox/loss_weight:
  desc: null
  value: 1.0
panoptic_head/roi_head/type:
  desc: null
  value: SAMAnchorPromptRoIHead
panoptic_head/roi_head/bbox_roi_extractor/type:
  desc: null
  value: mmdet.SingleRoIExtractor
panoptic_head/roi_head/bbox_roi_extractor/roi_layer/type:
  desc: null
  value: RoIAlign
panoptic_head/roi_head/bbox_roi_extractor/roi_layer/output_size:
  desc: null
  value: 7
panoptic_head/roi_head/bbox_roi_extractor/roi_layer/sampling_ratio:
  desc: null
  value: 0
panoptic_head/roi_head/bbox_roi_extractor/out_channels:
  desc: null
  value: 256
panoptic_head/roi_head/bbox_roi_extractor/featmap_strides:
  desc: null
  value:
  - 8
  - 16
  - 32
panoptic_head/roi_head/bbox_head/type:
  desc: null
  value: mmdet.Shared2FCBBoxHead
panoptic_head/roi_head/bbox_head/in_channels:
  desc: null
  value: 256
panoptic_head/roi_head/bbox_head/fc_out_channels:
  desc: null
  value: 1024
panoptic_head/roi_head/bbox_head/roi_feat_size:
  desc: null
  value: 7
panoptic_head/roi_head/bbox_head/num_classes:
  desc: null
  value: 1
panoptic_head/roi_head/bbox_head/bbox_coder/type:
  desc: null
  value: mmdet.DeltaXYWHBBoxCoder
panoptic_head/roi_head/bbox_head/bbox_coder/target_means:
  desc: null
  value:
  - 0.0
  - 0.0
  - 0.0
  - 0.0
panoptic_head/roi_head/bbox_head/bbox_coder/target_stds:
  desc: null
  value:
  - 0.1
  - 0.1
  - 0.2
  - 0.2
panoptic_head/roi_head/bbox_head/reg_class_agnostic:
  desc: null
  value: false
panoptic_head/roi_head/bbox_head/loss_cls/type:
  desc: null
  value: mmdet.CrossEntropyLoss
panoptic_head/roi_head/bbox_head/loss_cls/use_sigmoid:
  desc: null
  value: false
panoptic_head/roi_head/bbox_head/loss_cls/loss_weight:
  desc: null
  value: 1.0
panoptic_head/roi_head/bbox_head/loss_bbox/type:
  desc: null
  value: mmdet.SmoothL1Loss
panoptic_head/roi_head/bbox_head/loss_bbox/loss_weight:
  desc: null
  value: 1.0
panoptic_head/roi_head/mask_roi_extractor/type:
  desc: null
  value: mmdet.SingleRoIExtractor
panoptic_head/roi_head/mask_roi_extractor/roi_layer/type:
  desc: null
  value: RoIAlign
panoptic_head/roi_head/mask_roi_extractor/roi_layer/output_size:
  desc: null
  value: 14
panoptic_head/roi_head/mask_roi_extractor/roi_layer/sampling_ratio:
  desc: null
  value: 0
panoptic_head/roi_head/mask_roi_extractor/out_channels:
  desc: null
  value: 256
panoptic_head/roi_head/mask_roi_extractor/featmap_strides:
  desc: null
  value:
  - 8
  - 16
  - 32
panoptic_head/roi_head/mask_head/type:
  desc: null
  value: SAMPromptMaskHead
panoptic_head/roi_head/mask_head/per_query_point:
  desc: null
  value: 4
panoptic_head/roi_head/mask_head/with_sincos:
  desc: null
  value: true
panoptic_head/roi_head/mask_head/class_agnostic:
  desc: null
  value: true
panoptic_head/roi_head/mask_head/loss_mask/type:
  desc: null
  value: mmdet.CrossEntropyLoss
panoptic_head/roi_head/mask_head/loss_mask/use_mask:
  desc: null
  value: true
panoptic_head/roi_head/mask_head/loss_mask/loss_weight:
  desc: null
  value: 1.0
panoptic_head/train_cfg/rpn/assigner/type:
  desc: null
  value: mmdet.MaxIoUAssigner
panoptic_head/train_cfg/rpn/assigner/pos_iou_thr:
  desc: null
  value: 0.7
panoptic_head/train_cfg/rpn/assigner/neg_iou_thr:
  desc: null
  value: 0.3
panoptic_head/train_cfg/rpn/assigner/min_pos_iou:
  desc: null
  value: 0.3
panoptic_head/train_cfg/rpn/assigner/match_low_quality:
  desc: null
  value: true
panoptic_head/train_cfg/rpn/assigner/ignore_iof_thr:
  desc: null
  value: -1
panoptic_head/train_cfg/rpn/sampler/type:
  desc: null
  value: mmdet.RandomSampler
panoptic_head/train_cfg/rpn/sampler/num:
  desc: null
  value: 512
panoptic_head/train_cfg/rpn/sampler/pos_fraction:
  desc: null
  value: 0.5
panoptic_head/train_cfg/rpn/sampler/neg_pos_ub:
  desc: null
  value: -1
panoptic_head/train_cfg/rpn/sampler/add_gt_as_proposals:
  desc: null
  value: false
panoptic_head/train_cfg/rpn/allowed_border:
  desc: null
  value: -1
panoptic_head/train_cfg/rpn/pos_weight:
  desc: null
  value: -1
panoptic_head/train_cfg/rpn/debug:
  desc: null
  value: false
panoptic_head/train_cfg/rpn_proposal/nms_pre:
  desc: null
  value: 2000
panoptic_head/train_cfg/rpn_proposal/max_per_img:
  desc: null
  value: 1000
panoptic_head/train_cfg/rpn_proposal/nms/type:
  desc: null
  value: nms
panoptic_head/train_cfg/rpn_proposal/nms/iou_threshold:
  desc: null
  value: 0.7
panoptic_head/train_cfg/rpn_proposal/min_bbox_size:
  desc: null
  value: 0
panoptic_head/train_cfg/rcnn/assigner/type:
  desc: null
  value: mmdet.MaxIoUAssigner
panoptic_head/train_cfg/rcnn/assigner/pos_iou_thr:
  desc: null
  value: 0.5
panoptic_head/train_cfg/rcnn/assigner/neg_iou_thr:
  desc: null
  value: 0.5
panoptic_head/train_cfg/rcnn/assigner/min_pos_iou:
  desc: null
  value: 0.5
panoptic_head/train_cfg/rcnn/assigner/match_low_quality:
  desc: null
  value: true
panoptic_head/train_cfg/rcnn/assigner/ignore_iof_thr:
  desc: null
  value: -1
panoptic_head/train_cfg/rcnn/sampler/type:
  desc: null
  value: mmdet.RandomSampler
panoptic_head/train_cfg/rcnn/sampler/num:
  desc: null
  value: 256
panoptic_head/train_cfg/rcnn/sampler/pos_fraction:
  desc: null
  value: 0.25
panoptic_head/train_cfg/rcnn/sampler/neg_pos_ub:
  desc: null
  value: -1
panoptic_head/train_cfg/rcnn/sampler/add_gt_as_proposals:
  desc: null
  value: true
panoptic_head/train_cfg/rcnn/mask_size:
  desc: null
  value: 1024
panoptic_head/train_cfg/rcnn/pos_weight:
  desc: null
  value: -1
panoptic_head/train_cfg/rcnn/debug:
  desc: null
  value: false
panoptic_head/test_cfg/rpn/nms_pre:
  desc: null
  value: 1000
panoptic_head/test_cfg/rpn/max_per_img:
  desc: null
  value: 1000
panoptic_head/test_cfg/rpn/nms/type:
  desc: null
  value: nms
panoptic_head/test_cfg/rpn/nms/iou_threshold:
  desc: null
  value: 0.7
panoptic_head/test_cfg/rpn/min_bbox_size:
  desc: null
  value: 0
panoptic_head/test_cfg/rcnn/score_thr:
  desc: null
  value: 0.05
panoptic_head/test_cfg/rcnn/nms/type:
  desc: null
  value: nms
panoptic_head/test_cfg/rcnn/nms/iou_threshold:
  desc: null
  value: 0.5
panoptic_head/test_cfg/rcnn/max_per_img:
  desc: null
  value: 100
panoptic_head/test_cfg/rcnn/mask_thr_binary:
  desc: null
  value: 0.5
need_train_names:
  desc: null
  value:
  - panoptic_head
  - data_preprocessor
train_cfg:
  desc: null
  value: null
test_cfg:
  desc: null
  value: null
hyperparameters/optimizer/type:
  desc: null
  value: AdamW
hyperparameters/optimizer/sub_model/panoptic_head/lr_mult:
  desc: null
  value: 1
hyperparameters/optimizer/lr:
  desc: null
  value: 0.0005
hyperparameters/optimizer/weight_decay:
  desc: null
  value: 0.001
hyperparameters/param_scheduler:
  desc: null
  value:
  - type: mmengine.optim.scheduler.lr_scheduler.LinearLR
    start_factor: 0.0001
    by_epoch: true
    begin: 0
    end: 1
    convert_to_iter_based: true
  - type: mmengine.optim.scheduler.lr_scheduler.CosineAnnealingLR
    T_max: 100
    by_epoch: true
    begin: 1
    end: 100
hyperparameters/evaluator/val_evaluator/type:
  desc: null
  value: CocoPLMetric
hyperparameters/evaluator/val_evaluator/metric:
  desc: null
  value:
  - bbox
  - segm
hyperparameters/evaluator/val_evaluator/proposal_nums:
  desc: null
  value:
  - 1
  - 10
  - 100
data_preprocessor/type:
  desc: null
  value: DetDataPreprocessor
data_preprocessor/mean:
  desc: null
  value:
  - 123.675
  - 116.28
  - 103.53
data_preprocessor/std:
  desc: null
  value:
  - 58.395
  - 57.12
  - 57.375
data_preprocessor/bgr_to_rgb:
  desc: null
  value: true
data_preprocessor/pad_size_divisor:
  desc: null
  value: 32
data_preprocessor/pad_mask:
  desc: null
  value: true
data_preprocessor/mask_pad_value:
  desc: null
  value: 0
config_cfg/custom_imports/imports:
  desc: null
  value:
  - mmseg.datasets
  - mmseg.models
config_cfg/custom_imports/allow_failed_imports:
  desc: null
  value: false
config_cfg/sub_model_train:
  desc: null
  value:
  - panoptic_head
  - data_preprocessor
config_cfg/sub_model_optim/panoptic_head/lr_mult:
  desc: null
  value: 1
config_cfg/max_epochs:
  desc: null
  value: 100
config_cfg/optimizer/type:
  desc: null
  value: AdamW
config_cfg/optimizer/sub_model/panoptic_head/lr_mult:
  desc: null
  value: 1
config_cfg/optimizer/lr:
  desc: null
  value: 0.0005
config_cfg/optimizer/weight_decay:
  desc: null
  value: 0.001
config_cfg/param_scheduler:
  desc: null
  value:
  - type: mmengine.optim.scheduler.LinearLR
    start_factor: 0.0001
    by_epoch: true
    begin: 0
    end: 1
    convert_to_iter_based: true
  - type: mmengine.optim.scheduler.CosineAnnealingLR
    T_max: 100
    by_epoch: true
    begin: 1
    end: 100
config_cfg/param_scheduler_callback/type:
  desc: null
  value: ParamSchedulerHook
config_cfg/evaluator_/type:
  desc: null
  value: mmpl.evaluation.metrics.CocoPLMetric
config_cfg/evaluator_/metric:
  desc: null
  value:
  - bbox
  - segm
config_cfg/evaluator_/proposal_nums:
  desc: null
  value:
  - 1
  - 10
  - 100
config_cfg/evaluator/val_evaluator/type:
  desc: null
  value: mmpl.evaluation.metrics.CocoPLMetric
config_cfg/evaluator/val_evaluator/metric:
  desc: null
  value:
  - bbox
  - segm
config_cfg/evaluator/val_evaluator/proposal_nums:
  desc: null
  value:
  - 1
  - 10
  - 100
config_cfg/image_size:
  desc: null
  value:
  - 1024
  - 1024
config_cfg/data_preprocessor/type:
  desc: null
  value: mmdet.models.data_preprocessors.DetDataPreprocessor
config_cfg/data_preprocessor/mean:
  desc: null
  value:
  - 123.675
  - 116.28
  - 103.53
config_cfg/data_preprocessor/std:
  desc: null
  value:
  - 58.395
  - 57.12
  - 57.375
config_cfg/data_preprocessor/bgr_to_rgb:
  desc: null
  value: true
config_cfg/data_preprocessor/pad_size_divisor:
  desc: null
  value: 32
config_cfg/data_preprocessor/pad_mask:
  desc: null
  value: true
config_cfg/data_preprocessor/mask_pad_value:
  desc: null
  value: 0
config_cfg/num_things_classes:
  desc: null
  value: 1
config_cfg/num_stuff_classes:
  desc: null
  value: 0
config_cfg/num_classes:
  desc: null
  value: 1
config_cfg/prompt_shape:
  desc: null
  value:
  - 90
  - 4
config_cfg/model_cfg/type:
  desc: null
  value: mmpl.models.SegSAMAnchorPLer
config_cfg/model_cfg/hyperparameters/optimizer/type:
  desc: null
  value: AdamW
config_cfg/model_cfg/hyperparameters/optimizer/sub_model/panoptic_head/lr_mult:
  desc: null
  value: 1
config_cfg/model_cfg/hyperparameters/optimizer/lr:
  desc: null
  value: 0.0005
config_cfg/model_cfg/hyperparameters/optimizer/weight_decay:
  desc: null
  value: 0.001
config_cfg/model_cfg/hyperparameters/param_scheduler:
  desc: null
  value:
  - type: mmengine.optim.scheduler.LinearLR
    start_factor: 0.0001
    by_epoch: true
    begin: 0
    end: 1
    convert_to_iter_based: true
  - type: mmengine.optim.scheduler.CosineAnnealingLR
    T_max: 100
    by_epoch: true
    begin: 1
    end: 100
config_cfg/model_cfg/hyperparameters/evaluator/val_evaluator/type:
  desc: null
  value: mmpl.evaluation.metrics.CocoPLMetric
config_cfg/model_cfg/hyperparameters/evaluator/val_evaluator/metric:
  desc: null
  value:
  - bbox
  - segm
config_cfg/model_cfg/hyperparameters/evaluator/val_evaluator/proposal_nums:
  desc: null
  value:
  - 1
  - 10
  - 100
config_cfg/model_cfg/need_train_names:
  desc: null
  value:
  - panoptic_head
  - data_preprocessor
config_cfg/model_cfg/data_preprocessor/type:
  desc: null
  value: mmdet.models.data_preprocessors.DetDataPreprocessor
config_cfg/model_cfg/data_preprocessor/mean:
  desc: null
  value:
  - 123.675
  - 116.28
  - 103.53
config_cfg/model_cfg/data_preprocessor/std:
  desc: null
  value:
  - 58.395
  - 57.12
  - 57.375
config_cfg/model_cfg/data_preprocessor/bgr_to_rgb:
  desc: null
  value: true
config_cfg/model_cfg/data_preprocessor/pad_size_divisor:
  desc: null
  value: 32
config_cfg/model_cfg/data_preprocessor/pad_mask:
  desc: null
  value: true
config_cfg/model_cfg/data_preprocessor/mask_pad_value:
  desc: null
  value: 0
config_cfg/model_cfg/backbone/type:
  desc: null
  value: vit_h
config_cfg/model_cfg/backbone/checkpoint:
  desc: null
  value: pretrain/sam/sam_vit_h_4b8939.pth
config_cfg/model_cfg/panoptic_head/type:
  desc: null
  value: mmpl.models.SAMAnchorInstanceHead
config_cfg/model_cfg/panoptic_head/neck/type:
  desc: null
  value: mmpl.models.SAMAggregatorNeck
config_cfg/model_cfg/panoptic_head/neck/in_channels:
  desc: null
  value:
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
  - 1280
config_cfg/model_cfg/panoptic_head/neck/inner_channels:
  desc: null
  value: 32
config_cfg/model_cfg/panoptic_head/neck/selected_channels:
  desc: null
  value:
  - 4
  - 6
  - 8
  - 10
  - 12
  - 14
  - 16
  - 18
  - 20
  - 22
  - 24
  - 26
  - 28
  - 30
config_cfg/model_cfg/panoptic_head/neck/out_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/neck/up_sample_scale:
  desc: null
  value: 4
config_cfg/model_cfg/panoptic_head/rpn_head/type:
  desc: null
  value: mmdet.RPNHead
config_cfg/model_cfg/panoptic_head/rpn_head/in_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/rpn_head/feat_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/rpn_head/anchor_generator/type:
  desc: null
  value: mmdet.AnchorGenerator
config_cfg/model_cfg/panoptic_head/rpn_head/anchor_generator/scales:
  desc: null
  value:
  - 2
  - 4
  - 8
  - 16
  - 32
  - 64
config_cfg/model_cfg/panoptic_head/rpn_head/anchor_generator/ratios:
  desc: null
  value:
  - 0.5
  - 1.0
  - 2.0
config_cfg/model_cfg/panoptic_head/rpn_head/anchor_generator/strides:
  desc: null
  value:
  - 8
  - 16
  - 32
config_cfg/model_cfg/panoptic_head/rpn_head/bbox_coder/type:
  desc: null
  value: mmdet.DeltaXYWHBBoxCoder
config_cfg/model_cfg/panoptic_head/rpn_head/bbox_coder/target_means:
  desc: null
  value:
  - 0.0
  - 0.0
  - 0.0
  - 0.0
config_cfg/model_cfg/panoptic_head/rpn_head/bbox_coder/target_stds:
  desc: null
  value:
  - 1.0
  - 1.0
  - 1.0
  - 1.0
config_cfg/model_cfg/panoptic_head/rpn_head/loss_cls/type:
  desc: null
  value: mmdet.CrossEntropyLoss
config_cfg/model_cfg/panoptic_head/rpn_head/loss_cls/use_sigmoid:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/rpn_head/loss_cls/loss_weight:
  desc: null
  value: 1.0
config_cfg/model_cfg/panoptic_head/rpn_head/loss_bbox/type:
  desc: null
  value: mmdet.SmoothL1Loss
config_cfg/model_cfg/panoptic_head/rpn_head/loss_bbox/loss_weight:
  desc: null
  value: 1.0
config_cfg/model_cfg/panoptic_head/roi_head/type:
  desc: null
  value: SAMAnchorPromptRoIHead
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/type:
  desc: null
  value: mmdet.SingleRoIExtractor
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/roi_layer/type:
  desc: null
  value: RoIAlign
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/roi_layer/output_size:
  desc: null
  value: 7
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/roi_layer/sampling_ratio:
  desc: null
  value: 0
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/out_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/roi_head/bbox_roi_extractor/featmap_strides:
  desc: null
  value:
  - 8
  - 16
  - 32
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/type:
  desc: null
  value: mmdet.Shared2FCBBoxHead
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/in_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/fc_out_channels:
  desc: null
  value: 1024
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/roi_feat_size:
  desc: null
  value: 7
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/num_classes:
  desc: null
  value: 1
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/bbox_coder/type:
  desc: null
  value: mmdet.DeltaXYWHBBoxCoder
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/bbox_coder/target_means:
  desc: null
  value:
  - 0.0
  - 0.0
  - 0.0
  - 0.0
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/bbox_coder/target_stds:
  desc: null
  value:
  - 0.1
  - 0.1
  - 0.2
  - 0.2
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/reg_class_agnostic:
  desc: null
  value: false
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/loss_cls/type:
  desc: null
  value: mmdet.CrossEntropyLoss
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/loss_cls/use_sigmoid:
  desc: null
  value: false
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/loss_cls/loss_weight:
  desc: null
  value: 1.0
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/loss_bbox/type:
  desc: null
  value: mmdet.SmoothL1Loss
config_cfg/model_cfg/panoptic_head/roi_head/bbox_head/loss_bbox/loss_weight:
  desc: null
  value: 1.0
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/type:
  desc: null
  value: mmdet.SingleRoIExtractor
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/roi_layer/type:
  desc: null
  value: RoIAlign
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/roi_layer/output_size:
  desc: null
  value: 14
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/roi_layer/sampling_ratio:
  desc: null
  value: 0
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/out_channels:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/roi_head/mask_roi_extractor/featmap_strides:
  desc: null
  value:
  - 8
  - 16
  - 32
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/type:
  desc: null
  value: mmpl.models.SAMPromptMaskHead
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/per_query_point:
  desc: null
  value: 4
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/with_sincos:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/class_agnostic:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/loss_mask/type:
  desc: null
  value: mmdet.CrossEntropyLoss
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/loss_mask/use_mask:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/roi_head/mask_head/loss_mask/loss_weight:
  desc: null
  value: 1.0
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/type:
  desc: null
  value: mmdet.MaxIoUAssigner
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/pos_iou_thr:
  desc: null
  value: 0.7
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/neg_iou_thr:
  desc: null
  value: 0.3
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/min_pos_iou:
  desc: null
  value: 0.3
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/match_low_quality:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/assigner/ignore_iof_thr:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/sampler/type:
  desc: null
  value: mmdet.RandomSampler
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/sampler/num:
  desc: null
  value: 512
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/sampler/pos_fraction:
  desc: null
  value: 0.5
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/sampler/neg_pos_ub:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/sampler/add_gt_as_proposals:
  desc: null
  value: false
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/allowed_border:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/pos_weight:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rpn/debug:
  desc: null
  value: false
config_cfg/model_cfg/panoptic_head/train_cfg/rpn_proposal/nms_pre:
  desc: null
  value: 2000
config_cfg/model_cfg/panoptic_head/train_cfg/rpn_proposal/max_per_img:
  desc: null
  value: 1000
config_cfg/model_cfg/panoptic_head/train_cfg/rpn_proposal/nms/type:
  desc: null
  value: nms
config_cfg/model_cfg/panoptic_head/train_cfg/rpn_proposal/nms/iou_threshold:
  desc: null
  value: 0.7
config_cfg/model_cfg/panoptic_head/train_cfg/rpn_proposal/min_bbox_size:
  desc: null
  value: 0
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/type:
  desc: null
  value: mmdet.MaxIoUAssigner
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/pos_iou_thr:
  desc: null
  value: 0.5
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/neg_iou_thr:
  desc: null
  value: 0.5
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/min_pos_iou:
  desc: null
  value: 0.5
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/match_low_quality:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/assigner/ignore_iof_thr:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/sampler/type:
  desc: null
  value: mmdet.RandomSampler
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/sampler/num:
  desc: null
  value: 256
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/sampler/pos_fraction:
  desc: null
  value: 0.25
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/sampler/neg_pos_ub:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/sampler/add_gt_as_proposals:
  desc: null
  value: true
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/mask_size:
  desc: null
  value: 1024
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/pos_weight:
  desc: null
  value: -1
config_cfg/model_cfg/panoptic_head/train_cfg/rcnn/debug:
  desc: null
  value: false
config_cfg/model_cfg/panoptic_head/test_cfg/rpn/nms_pre:
  desc: null
  value: 1000
config_cfg/model_cfg/panoptic_head/test_cfg/rpn/max_per_img:
  desc: null
  value: 1000
config_cfg/model_cfg/panoptic_head/test_cfg/rpn/nms/type:
  desc: null
  value: nms
config_cfg/model_cfg/panoptic_head/test_cfg/rpn/nms/iou_threshold:
  desc: null
  value: 0.7
config_cfg/model_cfg/panoptic_head/test_cfg/rpn/min_bbox_size:
  desc: null
  value: 0
config_cfg/model_cfg/panoptic_head/test_cfg/rcnn/score_thr:
  desc: null
  value: 0.05
config_cfg/model_cfg/panoptic_head/test_cfg/rcnn/nms/type:
  desc: null
  value: nms
config_cfg/model_cfg/panoptic_head/test_cfg/rcnn/nms/iou_threshold:
  desc: null
  value: 0.5
config_cfg/model_cfg/panoptic_head/test_cfg/rcnn/max_per_img:
  desc: null
  value: 100
config_cfg/model_cfg/panoptic_head/test_cfg/rcnn/mask_thr_binary:
  desc: null
  value: 0.5
config_cfg/task_name:
  desc: null
  value: dev
config_cfg/exp_name:
  desc: null
  value: sam-anchor-E20230720_01
config_cfg/logger/type:
  desc: null
  value: WandbLogger
config_cfg/logger/project:
  desc: null
  value: dev
config_cfg/logger/group:
  desc: null
  value: sam-anchor
config_cfg/logger/name:
  desc: null
  value: sam-anchor-E20230720_01
config_cfg/callbacks:
  desc: null
  value:
  - type: ParamSchedulerHook
  - type: ModelCheckpoint
    dirpath: results/dev/sam-anchor-E20230720_01/checkpoints
    save_last: true
    mode: max
    monitor: valsegm_map_0
    save_top_k: 3
    filename: epoch_{epoch}-map_{valsegm_map_0:.4f}
  - type: LearningRateMonitor
    logging_interval: step
config_cfg/trainer_cfg/compiled_model:
  desc: null
  value: false
config_cfg/trainer_cfg/accelerator:
  desc: null
  value: auto
config_cfg/trainer_cfg/strategy:
  desc: null
  value: auto
config_cfg/trainer_cfg/devices:
  desc: null
  value: 1
config_cfg/trainer_cfg/default_root_dir:
  desc: null
  value: results/dev/sam-anchor-E20230720_01
config_cfg/trainer_cfg/max_epochs:
  desc: null
  value: 100
config_cfg/trainer_cfg/logger/type:
  desc: null
  value: WandbLogger
config_cfg/trainer_cfg/logger/project:
  desc: null
  value: dev
config_cfg/trainer_cfg/logger/group:
  desc: null
  value: sam-anchor
config_cfg/trainer_cfg/logger/name:
  desc: null
  value: sam-anchor-E20230720_01
config_cfg/trainer_cfg/callbacks:
  desc: null
  value:
  - type: ParamSchedulerHook
  - type: ModelCheckpoint
    dirpath: results/dev/sam-anchor-E20230720_01/checkpoints
    save_last: true
    mode: max
    monitor: valsegm_map_0
    save_top_k: 3
    filename: epoch_{epoch}-map_{valsegm_map_0:.4f}
  - type: LearningRateMonitor
    logging_interval: step
config_cfg/trainer_cfg/log_every_n_steps:
  desc: null
  value: 10
config_cfg/trainer_cfg/check_val_every_n_epoch:
  desc: null
  value: 5
config_cfg/trainer_cfg/benchmark:
  desc: null
  value: true
config_cfg/trainer_cfg/use_distributed_sampler:
  desc: null
  value: true
config_cfg/backend_args:
  desc: null
  value: null
config_cfg/train_pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.RandomFlip
    prob: 0.5
  - type: mmdet.PackDetInputs
config_cfg/test_pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
    backend_args: null
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.PackDetInputs
    meta_keys:
    - img_id
    - img_path
    - ori_shape
    - img_shape
    - scale_factor
config_cfg/train_batch_size_per_gpu:
  desc: null
  value: 2
config_cfg/train_num_workers:
  desc: null
  value: 2
config_cfg/test_batch_size_per_gpu:
  desc: null
  value: 2
config_cfg/test_num_workers:
  desc: null
  value: 2
config_cfg/persistent_workers:
  desc: null
  value: true
config_cfg/data_parent:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/
config_cfg/train_data_prefix:
  desc: null
  value: train/
config_cfg/val_data_prefix:
  desc: null
  value: test/
config_cfg/dataset_type:
  desc: null
  value: WHUInsSegDataset
config_cfg/val_loader/batch_size:
  desc: null
  value: 2
config_cfg/val_loader/num_workers:
  desc: null
  value: 2
config_cfg/val_loader/persistent_workers:
  desc: null
  value: true
config_cfg/val_loader/pin_memory:
  desc: null
  value: true
config_cfg/val_loader/dataset/type:
  desc: null
  value: WHUInsSegDataset
config_cfg/val_loader/dataset/data_root:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/
config_cfg/val_loader/dataset/ann_file:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/annotations/WHU_building_test.json
config_cfg/val_loader/dataset/data_prefix/img:
  desc: null
  value: test//image
config_cfg/val_loader/dataset/test_mode:
  desc: null
  value: true
config_cfg/val_loader/dataset/filter_cfg/filter_empty_gt:
  desc: null
  value: true
config_cfg/val_loader/dataset/filter_cfg/min_size:
  desc: null
  value: 32
config_cfg/val_loader/dataset/pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
    backend_args: null
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.PackDetInputs
    meta_keys:
    - img_id
    - img_path
    - ori_shape
    - img_shape
    - scale_factor
config_cfg/val_loader/dataset/backend_args:
  desc: null
  value: null
config_cfg/datamodule_cfg/type:
  desc: null
  value: PLDataModule
config_cfg/datamodule_cfg/train_loader/batch_size:
  desc: null
  value: 2
config_cfg/datamodule_cfg/train_loader/num_workers:
  desc: null
  value: 2
config_cfg/datamodule_cfg/train_loader/persistent_workers:
  desc: null
  value: true
config_cfg/datamodule_cfg/train_loader/pin_memory:
  desc: null
  value: true
config_cfg/datamodule_cfg/train_loader/dataset/type:
  desc: null
  value: WHUInsSegDataset
config_cfg/datamodule_cfg/train_loader/dataset/data_root:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/
config_cfg/datamodule_cfg/train_loader/dataset/ann_file:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/annotations/WHU_building_train.json
config_cfg/datamodule_cfg/train_loader/dataset/data_prefix/img:
  desc: null
  value: train//image
config_cfg/datamodule_cfg/train_loader/dataset/filter_cfg/filter_empty_gt:
  desc: null
  value: true
config_cfg/datamodule_cfg/train_loader/dataset/filter_cfg/min_size:
  desc: null
  value: 32
config_cfg/datamodule_cfg/train_loader/dataset/pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.RandomFlip
    prob: 0.5
  - type: mmdet.PackDetInputs
config_cfg/datamodule_cfg/train_loader/dataset/backend_args:
  desc: null
  value: null
config_cfg/datamodule_cfg/val_loader/batch_size:
  desc: null
  value: 2
config_cfg/datamodule_cfg/val_loader/num_workers:
  desc: null
  value: 2
config_cfg/datamodule_cfg/val_loader/persistent_workers:
  desc: null
  value: true
config_cfg/datamodule_cfg/val_loader/pin_memory:
  desc: null
  value: true
config_cfg/datamodule_cfg/val_loader/dataset/type:
  desc: null
  value: WHUInsSegDataset
config_cfg/datamodule_cfg/val_loader/dataset/data_root:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/
config_cfg/datamodule_cfg/val_loader/dataset/ann_file:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/annotations/WHU_building_test.json
config_cfg/datamodule_cfg/val_loader/dataset/data_prefix/img:
  desc: null
  value: test//image
config_cfg/datamodule_cfg/val_loader/dataset/test_mode:
  desc: null
  value: true
config_cfg/datamodule_cfg/val_loader/dataset/filter_cfg/filter_empty_gt:
  desc: null
  value: true
config_cfg/datamodule_cfg/val_loader/dataset/filter_cfg/min_size:
  desc: null
  value: 32
config_cfg/datamodule_cfg/val_loader/dataset/pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
    backend_args: null
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.PackDetInputs
    meta_keys:
    - img_id
    - img_path
    - ori_shape
    - img_shape
    - scale_factor
config_cfg/datamodule_cfg/val_loader/dataset/backend_args:
  desc: null
  value: null
config_cfg/datamodule_cfg/predict_loader/batch_size:
  desc: null
  value: 2
config_cfg/datamodule_cfg/predict_loader/num_workers:
  desc: null
  value: 2
config_cfg/datamodule_cfg/predict_loader/persistent_workers:
  desc: null
  value: true
config_cfg/datamodule_cfg/predict_loader/pin_memory:
  desc: null
  value: true
config_cfg/datamodule_cfg/predict_loader/dataset/type:
  desc: null
  value: WHUInsSegDataset
config_cfg/datamodule_cfg/predict_loader/dataset/data_root:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/
config_cfg/datamodule_cfg/predict_loader/dataset/ann_file:
  desc: null
  value: /nfs/home/3002_hehui/xmx/data/WHU/annotations/WHU_building_test.json
config_cfg/datamodule_cfg/predict_loader/dataset/data_prefix/img:
  desc: null
  value: test//image
config_cfg/datamodule_cfg/predict_loader/dataset/test_mode:
  desc: null
  value: true
config_cfg/datamodule_cfg/predict_loader/dataset/filter_cfg/filter_empty_gt:
  desc: null
  value: true
config_cfg/datamodule_cfg/predict_loader/dataset/filter_cfg/min_size:
  desc: null
  value: 32
config_cfg/datamodule_cfg/predict_loader/dataset/pipeline:
  desc: null
  value:
  - type: mmdet.LoadImageFromFile
    backend_args: null
  - type: mmdet.Resize
    scale:
    - 1024
    - 1024
  - type: mmdet.LoadAnnotations
    with_bbox: true
    with_mask: true
  - type: mmdet.PackDetInputs
    meta_keys:
    - img_id
    - img_path
    - ori_shape
    - img_shape
    - scale_factor
config_cfg/datamodule_cfg/predict_loader/dataset/backend_args:
  desc: null
  value: null
config_cfg/resume:
  desc: null
  value: null
